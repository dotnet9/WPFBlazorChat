@using WPFBlazorChat.Core.Services
@using WPFBlazorChat.Shared.Models
@using WPFBlazorChat.Shared.Services
@inject User CurrentUser
@inject IWindowService WindowService
@inject IUserService UserService


<MApp>
    <!--标题栏开始-->
    <MAppBar App @onmousedown="WindowService.StartMove" @onmouseup="WindowService.StopMove" @ondblclick="WindowService.Maximize"
             ElevateOnScroll Color="white" Dense Absolute ScrollTarget="#scrolling-sheet-2">
        <MAppBarNavIcon></MAppBarNavIcon>
        <MAppBarTitle>Title</MAppBarTitle>
        <MSpacer></MSpacer>

        <MButton Icon OnClick="WindowService.Minimize">
            <MIcon>mdi-window-minimize</MIcon>
        </MButton>
        <MButton Icon OnClick="WindowService.Maximize">
            @if (WindowService.IsMaximized())
            {
                <MIcon>mdi-window-restore</MIcon>
            }
            else
            {
                <MIcon>mdi-window-maximize</MIcon>
            }
        </MButton>
        <MButton Icon OnClick="WindowService.Close">
            <MIcon>mdi-close</MIcon>
        </MButton>

    </MAppBar>
    <!--标题栏结束-->

    <MMain>
        <MRow>
            <!--左侧快捷菜单开始-->
            <MList Width="55">
                <MListItemGroup
                    @bind-Value="_model"
                    Color="indigo">

                    <MListItem @key="@CurrentUser.UserName">
                        <MListItemAvatar>
                            <MImage Src="@CurrentUser.Avatar"></MImage>
                        </MListItemAvatar>
                    </MListItem>
                    @foreach (var item in quickMenus)
                    {
                        <MListItem @key="item">
                            <MListItemIcon>
                                <MIcon>@item.icon</MIcon>
                            </MListItemIcon>
                        </MListItem>
                    }
                </MListItemGroup>
            </MList>
            <!--左侧快捷菜单结束-->

            <MDivider Vertical></MDivider>

            <!--中间好友列表（群）开始-->
            <MCol Cols="3">
                <MList ThreeLine>
                    @if (_users is {Count: > 0})
                    {
                        @foreach (var user in _users)
                        {
                            if (user.Id == CurrentUser.Id)
                            {
                                continue;
                            }
                            <MListItem OnClick="() => ShowUser(user)">
                                <MListItemAvatar>
                                    <MImage Src="@user.Avatar"></MImage>
                                </MListItemAvatar>

                                <MListItemContent>
                                    <MListItemTitle>@(user.UserName)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11:42 pm</MListItemTitle>
                                    <MListItemSubtitle>待会儿吃？</MListItemSubtitle>
                                </MListItemContent>
                            </MListItem>
                        }
                    }
                </MList>
            </MCol>
            <!--中间好友列表（群）结束-->

            <MDivider Vertical></MDivider>

            <!--右侧聊天区开始-->
            <MCol Cols="21">
                <MRow>
                    <MToolbar Flat>
                        <ChildContent>
                            <MToolbarTitle>@_checkedUser?.UserName</MToolbarTitle>

                            <MSpacer></MSpacer>
                        </ChildContent>
                    </MToolbar>
                </MRow>
                <MDivider Inset="true"></MDivider>
                <MRow>
                    <MTextarea
                        RowHeight="20"
                        Rows="18" Class="mx-4"
                        Name="input-7-1"
                        @bind-Value="_receiveMsg">
                    </MTextarea>
                </MRow>
                <MDivider Inset="true"></MDivider>
                <MRow>
                    <MTextarea AppendIcon="mdi-microphone"
                               Class="mx-4"
                               RowHeight="20"
                               Rows="5"
                               HideDetails="@true"
                               Label="请输入聊天内容"
                               @bind-Value="_chatMsg">
                    </MTextarea>
                </MRow>
            </MCol>
            <!--右侧聊天区结束-->
        </MRow>
    </MMain>
</MApp>